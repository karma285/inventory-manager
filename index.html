<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>html5-qrcode 카메라 테스트</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 400px;
    margin: 40px auto;
    text-align: center;
  }
  #reader {
    width: 100%;
    height: 300px;
    border: 1px solid #ddd;
    margin-top: 20px;
  }
</style>
</head>
<body>
<h1>📷 카메라 & 바코드 스캔 테스트</h1>
<div id="reader"></div>

<script src="https://unpkg.com/html5-qrcode@2.2.1/minified/html5-qrcode.min.js"></script>
<script>
  const html5QrCode = new Html5Qrcode("reader");

  // 카메라 목록 얻기
  Html5Qrcode.getCameras().then(cameras => {
    if (cameras && cameras.length) {
      // 후면 카메라 우선 찾기
      const backCamera = cameras.find(cam => /back|rear|environment/gi.test(cam.label)) || cameras[0];
      html5QrCode.start(
        backCamera.id,
        {
          fps: 10,
          qrbox: 250
        },
        decodedText => {
          alert(`바코드 인식: ${decodedText}`);
          // 스캔 후 카메라 정지 (필요하면 주석처리 가능)
          html5QrCode.stop();
        },
        errorMessage => {
          // 스캔 실패시 에러 무시
        }
      ).catch(err => {
        alert(`카메라 시작 오류: ${err}`);
      });
    } else {
      alert("사용 가능한 카메라가 없습니다.");
    }
  }).catch(err => {
    alert(`카메라 정보 가져오기 실패: ${err}`);
  });
</script>
</body>
</html>
